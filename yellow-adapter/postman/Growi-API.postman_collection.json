{
  "info": {
    "name": "Growi Campaign Manager",
    "_postman_id": "growi-complete-v2",
    "description": "API completa para Growi - Sistema de pagos off-chain con Yellow Network",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "‚úÖ 1. Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/api/yellow/health",
          "host": ["{{baseUrl}}"],
          "path": ["api", "yellow", "health"]
        },
        "description": "‚úÖ Verifica que el servidor est√° funcionando.\n\n**Esperado:** 200 OK con status healthy"
      },
      "response": []
    },
    {
      "name": "üÜï 2. Create Session (Manager)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Guardar Session ID autom√°ticamente",
              "if (pm.response.code === 200) {",
              "    const response = pm.response.json();",
              "    if (response.ok && response.data.appSessionId) {",
              "        pm.environment.set('sessionId', response.data.appSessionId);",
              "        console.log('‚úÖ Session ID guardado:', response.data.appSessionId);",
              "        console.log('üìã Copia este ID para el siguiente request');",
              "    }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"budgetUsdc\": \"{{budget}}\",\n  \"managerAddress\": \"{{managerAddress}}\",\n  \"influencerAddress\": \"{{influencerAddress}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/yellow/app-sessions/create",
          "host": ["{{baseUrl}}"],
          "path": ["api", "yellow", "app-sessions", "create"]
        },
        "description": "üÜï Crea una nueva campa√±a con presupuesto inicial.\n\n**Manager Address**: Wallet del manager (viene del frontend con WAAP)\n**Influencer Address**: Wallet del influencer\n**Budget**: 1,000,000 units = 1 USDC\n\n‚ö° El Session ID se guarda autom√°ticamente en la variable {{sessionId}}"
      },
      "response": []
    },
    {
      "name": "üìä 3. Get Session Details",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/api/yellow/app-sessions/{{sessionId}}",
          "host": ["{{baseUrl}}"],
          "path": ["api", "yellow", "app-sessions", "{{sessionId}}"]
        },
        "description": "üìä Obtiene los detalles de una sesi√≥n.\n\n**Usa el Session ID guardado** del request anterior.\n\n**Response incluye:**\n- Definition (protocol, participants, weights)\n- Allocations (balances actuales)\n- Version (n√∫mero de actualizaciones)"
      },
      "response": []
    },
    {
      "name": "üí∞ 4. Apply Payout (Admin)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"appSessionId\": \"{{sessionId}}\",\n  \"earnedUsdc\": \"{{earnedAmount}}\",\n  \"feeBps\": {{feeBps}}\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/yellow/app-sessions/payout",
          "host": ["{{baseUrl}}"],
          "path": ["api", "yellow", "app-sessions", "payout"]
        },
        "description": "üí∞ Aplica un payout al influencer.\n\n**Admin ejecuta esto** para mover fondos del Manager al Influencer.\n\n**Earned**: 250,000 units = 0.25 USDC\n**Fee**: 200 BPS = 2%\n\n**C√°lculo:**\n- Fee = (250,000 √ó 200) / 10,000 = 5,000 units\n- Total = 255,000 units\n- Manager pierde: 255,000\n- Influencer gana: 250,000\n- Fee Treasury gana: 5,000\n\nüîê Growi Judge firma autom√°ticamente (backend)"
      },
      "response": []
    },
    {
      "name": "üí∏ 5. Claim Funds (Influencer)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"appSessionId\": \"{{sessionId}}\",\n  \"participant\": \"{{influencerAddress}}\",\n  \"amountUsdc\": \"{{claimAmount}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/yellow/app-sessions/claim",
          "host": ["{{baseUrl}}"],
          "path": ["api", "yellow", "app-sessions", "claim"]
        },
        "description": "üí∏ El influencer retira sus fondos.\n\n**Participant**: Wallet del influencer\n**Amount**: 250,000 units = 0.25 USDC\n\n‚ö†Ô∏è El participant debe tener balance suficiente.\n‚ö†Ô∏è Esto es OFF-CHAIN (virtual, no requiere gas)"
      },
      "response": []
    },
    {
      "name": "üö∞ 6. Request Faucet (Optional)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"userAddress\": \"{{managerAddress}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/yellow/faucet",
          "host": ["{{baseUrl}}"],
          "path": ["api", "yellow", "faucet"]
        },
        "description": "üö∞ Solicita ytest.usd de prueba.\n\n‚ö†Ô∏è SOLO para transacciones on-chain reales.\n‚ö†Ô∏è NO necesario para App Sessions (off-chain).\n\n**Amount**: 1 ytest.usd = 1,000,000 units\n\nPara ETH de gas: https://www.alchemy.com/faucets/base-sepolia"
      },
      "response": []
    }
  ],
  "variable": []
}
