{
  "info": {
    "name": "ENS Writer API",
    "description": "Colección de endpoints para ENS Writer - Gestión de campañas con ENS y Merkle trees",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health Checks",
      "item": [
        {
          "name": "Health Check Pinata",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/api/health/pinata",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "health", "pinata"]
            },
            "description": "Valida que la configuración de Pinata esté correcta y funcional."
          },
          "response": []
        },
        {
          "name": "Health Check Supabase",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/api/health/supabase",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "health", "supabase"]
            },
            "description": "Valida que la configuración de Supabase esté correcta y funcional."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Campaigns",
      "item": [
        {
          "name": "List Campaigns by Wallet",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/api/campaigns?wallet={{WALLET_ADDRESS}}",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "campaigns"],
              "query": [
                {
                  "key": "wallet",
                  "value": "{{WALLET_ADDRESS}}",
                  "description": "Wallet address (0x...)"
                }
              ]
            },
            "description": "Lista campañas asociadas a una wallet (como manager o como beneficiario)."
          },
          "response": []
        },
        {
          "name": "Get Campaign Payouts",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/api/campaigns/{{CAMPAIGN_CODE}}/payouts",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "campaigns", "{{CAMPAIGN_CODE}}", "payouts"]
            },
            "description": "Lista todos los payouts de una campaña."
          },
          "response": []
        },
        {
          "name": "Upsert Campaign Payouts",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"payouts\": [\n    {\n      \"wallet\": \"0x1234567890123456789012345678901234567890\",\n      \"amount_micros\": \"1000000\"\n    },\n    {\n      \"wallet\": \"0x0987654321098765432109876543210987654321\",\n      \"amount_micros\": \"2000000\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/campaigns/{{CAMPAIGN_CODE}}/payouts",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "campaigns", "{{CAMPAIGN_CODE}}", "payouts"]
            },
            "description": "Agregar o actualizar payouts para una campaña."
          },
          "response": []
        }
      ]
    },
    {
      "name": "ENS Campaigns",
      "item": [
        {
          "name": "Create Campaign on ENS",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "{{ENS_WRITER_API_KEY}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"test1\",\n  \"campaignId\": \"campaign-123\",\n  \"campaignName\": \"Test Campaign\",\n  \"description\": \"This is a test campaign\",\n  \"startDate\": 1704067200,\n  \"endDate\": 1735689600,\n  \"campaignManager\": \"test-manager\",\n  \"yellowChannelId\": \"channel-123\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/ens/campaigns",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "ens", "campaigns"]
            },
            "description": "Crea una nueva campaña en ENS. Requiere autenticación con x-api-key."
          },
          "response": []
        },
        {
          "name": "Get Campaign from ENS",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "x-api-key",
                "value": "{{ENS_WRITER_API_KEY}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/ens/campaigns/{{CAMPAIGN_CODE}}",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "ens", "campaigns", "{{CAMPAIGN_CODE}}"]
            },
            "description": "Lee los text records de una campaña desde ENS (blockchain)."
          },
          "response": []
        },
        {
          "name": "Finalize Campaign",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "x-api-key",
                "value": "{{ENS_WRITER_API_KEY}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"settlementTx\": \"0x1234567890123456789012345678901234567890123456789012345678901234\",\n  \"payouts\": [\n    [\"0x1234567890123456789012345678901234567890\", \"1000000\"],\n    [\"0x0987654321098765432109876543210987654321\", \"2000000\"]\n  ]\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/ens/campaigns/{{CAMPAIGN_CODE}}/finalize",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "ens", "campaigns", "{{CAMPAIGN_CODE}}", "finalize"]
            },
            "description": "Finaliza una campaña escribiendo settlement y payout records. Requiere autenticación con x-api-key."
          },
          "response": []
        },
        {
          "name": "Generate Proof for Wallet",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/api/ens/campaigns/{{CAMPAIGN_CODE}}/proof?wallet={{WALLET_ADDRESS}}",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "ens", "campaigns", "{{CAMPAIGN_CODE}}", "proof"],
              "query": [
                {
                  "key": "wallet",
                  "value": "{{WALLET_ADDRESS}}",
                  "description": "Wallet address (0x...)"
                }
              ]
            },
            "description": "Genera Merkle proof on-demand para una wallet específica."
          },
          "response": []
        }
      ]
    },
    {
      "name": "ENS Text Records",
      "item": [
        {
          "name": "Read ENS Text Record",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/api/ens/text?name={{ENS_NAME}}&key={{TEXT_RECORD_KEY}}",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "ens", "text"],
              "query": [
                {
                  "key": "name",
                  "value": "{{ENS_NAME}}",
                  "description": "ENS name (e.g., test1.growi.eth)"
                },
                {
                  "key": "key",
                  "value": "{{TEXT_RECORD_KEY}}",
                  "description": "Text record key (e.g., growi:payoutRoot)"
                }
              ]
            },
            "description": "Lee un text record de ENS nombre sin exponer RPC_URL al cliente."
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "BASE_URL",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "CAMPAIGN_CODE",
      "value": "test1",
      "type": "string"
    },
    {
      "key": "WALLET_ADDRESS",
      "value": "0x1234567890123456789012345678901234567890",
      "type": "string"
    },
    {
      "key": "ENS_NAME",
      "value": "test1.growi.eth",
      "type": "string"
    },
    {
      "key": "TEXT_RECORD_KEY",
      "value": "growi:payoutRoot",
      "type": "string"
    },
    {
      "key": "ENS_WRITER_API_KEY",
      "value": "your-api-key-here",
      "type": "string"
    }
  ]
}
